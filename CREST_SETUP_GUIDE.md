# Crest Ocean System - Complete Setup Guide

## Overview
Crest is a high-quality ocean/water system for Unity. This guide will walk you through setting it up properly in your scene.

## Prerequisites

### System Requirements
- **Unity Version**: 2021.3 or later (recommended: 2022.3+)
- **Render Pipeline**: Universal Render Pipeline (URP) or High Definition Render Pipeline (HDRP)
- **Graphics API**: DirectX 11/12, Vulkan, or Metal (NOT OpenGL)
- **Shader Model**: 4.5 or higher
- **Compute Shaders**: Required
- **2D Array Textures**: Required

### Check Compatibility
1. Go to **Edit** â†’ **Project Settings** â†’ **Player**
2. Under **Other Settings**, verify:
   - Graphics API includes DirectX 11/12 or Vulkan
   - Shader Model is 4.5 or higher
3. Go to **Edit** â†’ **Project Settings** â†’ **Graphics**
4. Verify your Render Pipeline Asset is assigned

## Step 1: Add WaterRenderer to Scene

### Method 1: Create from Scratch
1. Create an empty GameObject in your scene
2. Name it **"Water"** or **"Ocean"**
3. Add Component â†’ Search for **"Water Renderer"**
4. The component will be added automatically

### Method 2: Use Prefab (Recommended)
1. In Project window, navigate to: `Packages/com.waveharmonic.crest/Runtime/Prefabs/`
2. Or check `Packages/com.waveharmonic.crest/Samples~/Main/Prefabs/` for example prefabs
3. Drag a prefab into your scene
4. Position it at sea level (Y = 0 or your desired water height)

## Step 2: Configure Basic Settings

### WaterRenderer Component Settings

#### General Settings
1. Select your **WaterRenderer** GameObject
2. In Inspector, find **WaterRenderer** component
3. Configure these essential settings:

**Viewpoint:**
- **Camera**: Assign your main camera (or leave empty to auto-detect)
- **Viewpoint**: Optional - assign a Transform to follow instead of camera
- **Follow Scene Camera**: âœ… Checked (for editor preview)

**Sea Level:**
- Position the GameObject's Y position = your desired sea level
- Example: Y = 0 for sea level, Y = 10 for elevated water

**Scale:**
- **Scale Range**: Min = 1, Max = 1000 (default)
- Controls how water scales with camera distance

## Step 3: Add Shape Components (Waves)

Waves are generated by **Shape components**, not directly on WaterRenderer!

### Add Shape Component (Waves)

**Method 1: Search in Add Component Menu**
1. Select your **WaterRenderer** GameObject (or any GameObject)
2. Click **"Add Component"** button
3. In the search box, type: **"Shape Gerstner"** or **"Shape FFT"**
4. Select the component from the list
5. The component will be added

**Method 2: Use Full Menu Path**
1. Select your **WaterRenderer** GameObject
2. **Add Component** â†’ **Crest** â†’ **Inputs** â†’ **Crest Shape Gerstner**
   - Or: **Crest** â†’ **Inputs** â†’ **Crest Shape FFT**
3. The component will be added

**Method 3: Add via Script (If menu doesn't appear)**
If the component doesn't appear in the menu, you can add it via script:
```csharp
// In a script or via Console
gameObject.AddComponent<WaveHarmonic.Crest.ShapeGerstner>();
```

**After Adding the Component:**
1. In the new component, expand **"Waves"** section
2. Find **"Spectrum"** field
3. Click the circle icon to select a Wave Spectrum asset
   - Default location: `Packages/com.waveharmonic.crest/Runtime/Data/WaveSpectra/`
   - Common options: `Waves.asset`, `WavesSwell.asset`

### Configure Wave Spectrum
1. Select the Wave Spectrum asset
2. In Inspector, adjust:
   - **Multiplier**: 1.0 (default) - Increase to 2-4 for bigger waves
   - **Gravity Scale**: 1.0 (default) - Controls wave speed
   - **Wave Direction Variance**: 90Â° (default) - Spread of wave directions

### Shape Component Settings

**Shape Gerstner:**
- **Resolution**: 64 (default) - Higher = better quality, more expensive
- **Components Per Octave**: 8 (default)
- **Random Seed**: 0 (default) - Change for different wave patterns
- **Override Global Wind Direction**: Unchecked (uses WaterRenderer wind)
- **Override Global Wind Speed**: Unchecked (uses WaterRenderer wind)

**Shape FFT (Alternative):**
- **Time Loop Length**: Infinity (default) - How long before waves loop
- **Wind Alignment**: 0-1 - How aligned waves are with wind
- **Maximum Vertical Displacement**: 10 (default) - Max wave height
- **Maximum Horizontal Displacement**: 15 (default) - Max horizontal movement

**Troubleshooting - Component Not Found:**

If you can't find Shape components in the Add Component menu:

1. **Check Menu Path:**
   - Look for: **Crest** â†’ **Inputs** â†’ **Crest Shape Gerstner**
   - Or search for: **"Shape Gerstner"** (without "Crest" prefix)

2. **Verify Crest Package:**
   - Check if Crest package is properly imported
   - Go to **Window** â†’ **Package Manager**
   - Look for "Crest" in the list
   - If missing, reimport the package

3. **Check Namespace:**
   - Components are in namespace: `WaveHarmonic.Crest`
   - Full class name: `ShapeGerstner` or `ShapeFFT`

4. **Alternative: Add via Code:**
   ```csharp
   // Create a temporary script or use Console
   using WaveHarmonic.Crest;
   gameObject.AddComponent<ShapeGerstner>();
   ```

5. **Check if Already Added:**
   - Select your WaterRenderer GameObject
   - Check if Shape component already exists in Inspector
   - Look for components starting with "Shape"

6. **Restart Unity:**
   - Sometimes components don't appear until Unity refreshes
   - Try: **Assets** â†’ **Refresh** (Ctrl+R)
   - Or restart Unity Editor

7. **Check Example Scenes:**
   - Open: `Packages/com.waveharmonic.crest/Samples~/Main/`
   - See how Shape components are added in example scenes

## Step 4: Configure Simulations

### Animated Waves (Required)
1. In WaterRenderer Inspector, expand **"Simulations"** section
2. Expand **"Animated Waves"**
3. Configure:
   - **Enabled**: âœ… Checked
   - **Resolution**: 256 (default) - Higher = better quality
   - **LOD Levels**: 4 (default) - Number of detail levels
   - **Maximum Vertical Displacement**: 50 (default) - Max wave height

### Other Simulations (Optional)
- **Water Depth**: For shallow water effects
- **Water Level**: For varying water heights
- **Foam**: For foam effects
- **Dynamic Waves**: For boat wakes and interactions
- **Flow**: For water currents
- **Shadows**: For water shadows
- **Absorption**: For underwater color
- **Scattering**: For water color

## Step 5: Configure Surface Rendering

### Surface Settings
1. Expand **"Surface"** section in WaterRenderer
2. Configure:
   - **Enabled**: âœ… Checked
   - **Layer**: Set to a dedicated layer (e.g., "Water")
   - **Material**: Assign a water material
     - Default: `Packages/com.waveharmonic.crest/Runtime/Materials/Water.mat`
   - **Injection Point**: Before Transparent (default)

### Material Setup
1. Select your water material
2. Adjust shader properties:
   - **Color**: Water tint color
   - **Smoothness**: 0.9 (default) - Water reflectivity
   - **Metallic**: 0.0 (default)
   - **Normal Map**: Optional - for surface detail

## Step 6: Configure Wind (Optional)

### Wind Settings
1. In WaterRenderer, find **"Wind"** section
2. Configure:
   - **Wind Zone**: Assign Unity WindZone (optional)
   - **Override Wind Zone Wind Speed**: Unchecked (uses WindZone)
   - **Wind Speed**: 20 km/h (default)
   - **Override Wind Zone Wind Direction**: Unchecked
   - **Wind Direction**: 0Â° (default) - Angle in degrees

### Create Wind Zone (Optional)
1. Create empty GameObject â†’ Name it "Wind Zone"
2. Add Component â†’ **Wind Zone**
3. Configure wind strength and direction
4. Assign to WaterRenderer's **Wind Zone** field

## Step 7: Add Dynamic Wave Interactions (Optional)

### For Objects That Create Waves (Boats, etc.)
1. Select the object that should create waves (e.g., boat)
2. **Add Component** â†’ Search for **"Sphere Water Interaction"**
   - Menu path: **Crest** â†’ **Inputs** â†’ **Crest Sphere Water Interaction**
   - Or search: **"Sphere Water"** or **"Water Interaction"**
3. Configure:
   - **Radius**: Size of wave generation area
   - **Weight**: Strength of waves generated
   - **Velocity Readback**: âœ… Checked (for moving objects)

**Note:** If component not found, search for variations:
- "SphereWaterInteraction" (no spaces)
- "Water Interaction"
- "Crest Sphere"

### For Rigidbody Objects
- Ensure object has **Rigidbody** component
- Set **Rigidbody** to non-kinematic (unless controlled by script)
- Waves will be generated automatically as object moves

## Step 8: Configure Camera

### Camera Settings
1. Select your Main Camera
2. Ensure:
   - **Culling Mask** includes the Water layer
   - **Clear Flags**: Skybox or Solid Color
   - **Background**: Set to appropriate color

### Underwater Effect (Optional)
1. In WaterRenderer, expand **"Underwater"** section
2. Configure:
   - **Enabled**: âœ… Checked
   - **Layer**: Set to a dedicated layer
   - **Volume Material**: Assign underwater material
   - **Fog Color**: Color of underwater fog
   - **Fog Density**: 0.1 (default)

## Step 9: Test and Validate

### Validation
1. Select **WaterRenderer** GameObject
2. In Inspector, click **"Validate Setup"** button (if available)
3. Check Console for any errors or warnings

### Common Issues

**No Water Visible:**
- âœ… Check camera culling mask includes Water layer
- âœ… Verify Surface is enabled
- âœ… Check water material is assigned
- âœ… Ensure camera is above water level

**Waves Not Showing:**
- âœ… Verify Shape Gerstner component is added
- âœ… Check Wave Spectrum is assigned
- âœ… Verify Animated Waves simulation is enabled
- âœ… Check Multiplier in Wave Spectrum > 0

**Performance Issues:**
- âœ… Lower Resolution in Animated Waves
- âœ… Reduce LOD Levels
- âœ… Lower Shape Gerstner Resolution
- âœ… Disable unused simulations

**Waves Too Big/Small:**
- âœ… Adjust **Multiplier** in Wave Spectrum (1-4 range)
- âœ… Adjust **Maximum Vertical Displacement** in Animated Waves

## Step 10: Fine-Tuning

### Wave Appearance
1. Select **Shape Gerstner** component
2. Adjust **Wave Spectrum** â†’ **Multiplier**: 1-4
3. Adjust **Resolution**: 32-128 (higher = smoother)
4. Adjust **Components Per Octave**: 4-16

### Water Appearance
1. Select water **Material**
2. Adjust **Color** tint
3. Adjust **Smoothness** (reflectivity)
4. Add **Normal Map** for surface detail

### Performance Optimization
1. Lower **Resolution** values if needed
2. Reduce **LOD Levels** if far from water
3. Disable unused **Simulations**
4. Use **Quality Settings** to reduce quality at distance

## Quick Reference

### Essential Components
- âœ… **WaterRenderer** - Main water system
- âœ… **Shape Gerstner** - Generates waves
- âœ… **Wave Spectrum** - Defines wave characteristics
- âœ… **Water Material** - Visual appearance

### Key Settings
- **Sea Level**: Y position of WaterRenderer GameObject
- **Wave Size**: Wave Spectrum â†’ Multiplier (1-4)
- **Wave Quality**: Animated Waves â†’ Resolution (128-512)
- **Water Layer**: Surface â†’ Layer (assign dedicated layer)

### File Locations
- **Wave Spectra**: `Packages/com.waveharmonic.crest/Runtime/Data/WaveSpectra/`
- **Materials**: `Packages/com.waveharmonic.crest/Runtime/Materials/`
- **Prefabs**: `Packages/com.waveharmonic.crest/Runtime/Prefabs/`
- **Examples**: `Packages/com.waveharmonic.crest/Samples~/`

## Troubleshooting

### Error: "Crest does not support OpenGL"
- **Fix**: Change Graphics API to DirectX 11/12 or Vulkan
- **Location**: Edit â†’ Project Settings â†’ Player â†’ Graphics API

### Error: "Shader level 4.5 required"
- **Fix**: Update graphics drivers or change Graphics API
- **Location**: Edit â†’ Project Settings â†’ Player â†’ Graphics API

### Water Not Rendering
- Check camera culling mask
- Verify Surface is enabled
- Check water material is assigned
- Ensure camera is above water

### Waves Not Generating
- Verify Shape Gerstner component exists
- Check Wave Spectrum is assigned
- Verify Animated Waves is enabled
- Check Multiplier > 0

### Performance Issues
- Lower Resolution settings
- Reduce LOD Levels
- Disable unused simulations
- Use Quality settings

## Next Steps

### Advanced Features
- **Dynamic Waves**: For boat wakes and interactions
- **Flow**: For water currents
- **Foam**: For foam effects
- **Underwater**: For underwater rendering
- **Reflections**: For water reflections

### Integration
- **Enviro 3**: Works well together (you're already using it!)
- **Physics**: Use SphereWaterInteraction for Rigidbody objects
- **Custom Waves**: Create custom Wave Spectrum assets

## Additional Resources

- **Manual**: `Packages/com.waveharmonic.crest/Documentation~/Manual.pdf`
- **API Reference**: `Packages/com.waveharmonic.crest/Documentation~/API.pdf`
- **Examples**: Check `Packages/com.waveharmonic.crest/Samples~/` folder

## Summary Checklist

- [ ] WaterRenderer GameObject created and positioned
- [ ] Shape Gerstner component added
- [ ] Wave Spectrum assigned
- [ ] Animated Waves simulation enabled
- [ ] Surface enabled and material assigned
- [ ] Camera culling mask includes Water layer
- [ ] Water layer created and assigned
- [ ] Basic settings configured
- [ ] Tested in Play mode
- [ ] Performance acceptable
- [ ] Waves visible and working

Your Crest ocean system should now be set up and working! ðŸŒŠ
